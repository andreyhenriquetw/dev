---
import "../styles/components/hero.css";
import DarkBg from "./DarkBg.astro";
import HeroIcons from "./HeroIcons.astro";
---
<section class="hero" id="hero" transition:persist>
  <div class="hero__contenedor">
    <div class="hero__saludo">
      <h1 class="hero__titulo" id="titulo-saludo">
        Hi! I'm 
        <span class="name-wrapper">
          A<span id="middle-text" class="expandable">ndre</span><span class="flicker-in-1 span__dark">Y</span><span id="suffix-text" class="expandable hidden-text">pslon</span>
        </span>
      </h1>
      
      <h2 class="hero__subtitulo" id="subtitulo">
        ≥ Projects developer in <span class="hero__subtitulo--span">Brazil</span>
      </h2>
    </div>
    <aside class="side__container">
      <img class="side__img img__ligth" src="./img/anddev.png" alt="Andre profile photo" />
      <img class="side__img img__dark" src="./img/anddev.png" alt="Andre profile photo" />
      <img class="side__img img__damage" src="./img/anddev.png" alt="Andre profile photo" />
      <HeroIcons />
    </aside>
  </div>
  <DarkBg />
</section>

<style>
  .name-wrapper {
    display: inline-flex;
    align-items: center;
    overflow: hidden;
    vertical-align: bottom;
  }

  .expandable {
    display: inline-block;
    max-width: 200px; /* Tamanho máximo aproximado */
    opacity: 1;
    transition: max-width 0.8s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.5s ease, margin 0.8s ease;
    white-space: nowrap;
  }

  /* Estado quando a letra "colhe" para dentro */
  .collapsed {
    max-width: 0px;
    opacity: 0;
    margin: 0;
    pointer-events: none;
  }

  .hidden-text {
    max-width: 0px;
    opacity: 0;
  }
</style>

<script>
  function startMutation() {
    const middle = document.getElementById('middle-text');
    const suffix = document.getElementById('suffix-text');

    if (!middle || !suffix) return;

    setInterval(() => {
      // Passo 1: Encolhe o "ndre" (Y encosta no A)
      middle.classList.add('collapsed');
      
      setTimeout(() => {
        // Passo 2: Expande o "pslon" para fora do Y
        suffix.classList.remove('hidden-text');
        
        setTimeout(() => {
          // Passo 3: Encolhe o "pslon" de volta
          suffix.classList.add('hidden-text');
          
          setTimeout(() => {
            // Passo 4: Expande o "ndre" original
            middle.classList.remove('collapsed');
          }, 800); // Tempo para o pslon sumir antes do ndre voltar
          
        }, 2500); // Tempo que fica como AYpslon
        
      }, 800); // Tempo da animação de encolher/encostar

    }, 7000); // Ciclo total (ajuste conforme necessário)
  }

  // Inicia no Astro
  document.addEventListener('astro:page-load', startMutation);
  startMutation();
</script>
